{% extends "docs/doc_layout.html" %}

{% block doc_title %}CRUD Operations - Python SDK{% endblock %}

{% block doc_content %}
{% set active_page = 'crud' %}

<h1 class="text-3xl font-bold text-white mb-2">CRUD & Bulk Operations</h1>
<p class="text-xl text-gray-400 mb-12">Core data manipulation methods.</p>

<!-- Insert -->
<section class="mb-16">
    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
        <span class="px-2 py-1 bg-green-500/10 text-green-400 text-xs font-mono rounded">INSERT</span>
        Insertions
    </h2>

    <h3 class="text-lg font-bold text-white mb-4">Single Document</h3>
    <pre class="bg-zinc-950 border border-white/10 rounded-xl p-4 mb-8 text-sm text-gray-300 overflow-x-auto"><code class="language-python">result = <span class="text-crous-400">await</span> collection.insert_one({
    <span class="text-green-400">"name"</span>: <span class="text-green-400">"Project X"</span>,
    <span class="text-green-400">"status"</span>: <span class="text-green-400">"active"</span>
})
print(result.inserted_id)</code></pre>

    <h3 class="text-lg font-bold text-white mb-4">Batch Insert (insert_many)</h3>
    <p class="text-gray-400 mb-4 text-sm">
        Efficiently insert multiple documents in a single network round-trip.
    </p>
    <pre class="bg-zinc-950 border border-white/10 rounded-xl p-4 mb-4 text-sm text-gray-300 overflow-x-auto"><code class="language-python">docs = [
    {<span class="text-green-400">"name"</span>: <span class="text-green-400">"Alice"</span>, <span class="text-green-400">"role"</span>: <span class="text-green-400">"dev"</span>},
    {<span class="text-green-400">"name"</span>: <span class="text-green-400">"Bob"</span>, <span class="text-green-400">"role"</span>: <span class="text-green-400">"admin"</span>}
]

ids = <span class="text-crous-400">await</span> collection.insert_many(docs, ordered=<span class="text-blue-400">True</span>)
print(f<span class="text-green-400">"Inserted {len(ids)} documents"</span>)</code></pre>
</section>

<!-- Query -->
<section class="mb-16">
    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
        <span class="px-2 py-1 bg-blue-500/10 text-blue-400 text-xs font-mono rounded">FIND</span>
        Querying Data
    </h2>
    <pre class="bg-zinc-950 border border-white/10 rounded-xl p-6 text-sm text-gray-300 overflow-x-auto"><code class="language-python"><span class="text-gray-500"># Find active projects with priority > 3</span>
cursor = <span class="text-crous-400">await</span> collection.find(
    {<span class="text-green-400">"status"</span>: <span class="text-green-400">"active"</span>, <span class="text-green-400">"priority"</span>: {<span class="text-green-400">"$gt"</span>: <span class="text-blue-400">3</span>}},
    sort=[[<span class="text-green-400">"priority"</span>, <span class="text-blue-400">-1</span>]], 
    limit=<span class="text-blue-400">20</span>
)

<span class="text-crous-400">for</span> doc <span class="text-crous-400">in</span> cursor.documents:
    print(doc)</code></pre>
</section>

<!-- Update -->
<section class="mb-16">
    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
        <span class="px-2 py-1 bg-orange-500/10 text-orange-400 text-xs font-mono rounded">UPDATE</span>
        Updates
    </h2>
    <pre class="bg-zinc-950 border border-white/10 rounded-xl p-6 mb-4 text-sm text-gray-300 overflow-x-auto"><code class="language-python"><span class="text-gray-500"># Update One</span>
<span class="text-crous-400">await</span> collection.update_one(
    {<span class="text-green-400">"_id"</span>: <span class="text-green-400">"doc_123"</span>},
    {<span class="text-green-400">"$set"</span>: {<span class="text-green-400">"status"</span>: <span class="text-green-400">"completed"</span>}}
)

<span class="text-gray-500"># Update Many</span>
result = <span class="text-crous-400">await</span> collection.update_many(
    {<span class="text-green-400">"status"</span>: <span class="text-green-400">"pending"</span>},
    {<span class="text-green-400">"$set"</span>: {<span class="text-green-400">"status"</span>: <span class="text-green-400">"archived"</span>}}
)
print(result.modified_count)</code></pre>
</section>

<!-- Bulk Write -->
<section>
    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
        <span class="px-2 py-1 bg-purple-500/10 text-purple-400 text-xs font-mono rounded">BATCH</span>
        Bulk Write Operations
    </h2>
    <p class="text-gray-400 mb-6">
        Execute a mixed list of write operations (insert, update, delete) in a single batch.
    </p>

    <div class="bg-zinc-950 border border-white/10 rounded-xl p-6 text-sm text-gray-300 overflow-x-auto">
        <code class="language-python">ops = [
    {<span class="text-green-400">"action"</span>: <span class="text-green-400">"insert"</span>, <span class="text-green-400">"document"</span>: {<span class="text-green-400">"name"</span>: <span class="text-green-400">"New Item"</span>}},
    {
        <span class="text-green-400">"action"</span>: <span class="text-green-400">"update"</span>, 
        <span class="text-green-400">"query"</span>: {<span class="text-green-400">"name"</span>: <span class="text-green-400">"Old Item"</span>}, 
        <span class="text-green-400">"update"</span>: {<span class="text-green-400">"$set"</span>: {<span class="text-green-400">"active"</span>: <span class="text-blue-400">False</span>}}
    },
    {<span class="text-green-400">"action"</span>: <span class="text-green-400">"delete"</span>, <span class="text-green-400">"query"</span>: {<span class="text-green-400">"status"</span>: <span class="text-green-400">"banned"</span>}}
]

<span class="text-gray-500"># Atomic = True means all succeed or all fail</span>
result = <span class="text-crous-400">await</span> collection.bulk_write(ops, atomic=<span class="text-blue-400">True</span>)
print(result) 
<span class="text-gray-500"># {'inserted_ids': [...], 'modified_count': 1, 'deleted_count': 5}</span></code>
    </div>
</section>

<div class="flex items-center justify-between pt-12 mt-12 border-t border-white/10">
    <a href="/docs/python/getting-started"
        class="flex items-center gap-2 text-gray-400 hover:text-white transition-colors">
        <i data-lucide="arrow-left" class="w-4 h-4"></i> Installation
    </a>
    <a href="/docs/python/indexing"
        class="flex items-center gap-2 text-white font-bold hover:text-crous-400 transition-colors">
        Indexing <i data-lucide="arrow-right" class="w-4 h-4"></i>
    </a>
</div>

{% endblock %}