{% extends "docs/doc_layout.html" %}

{% block doc_title %}Error Handling - Python SDK{% endblock %}

{% block doc_content %}
{% set active_page = 'errors' %}

<div class="mb-8">
    <h1
        class="text-4xl font-extrabold text-white mb-4 bg-gradient-to-r from-white to-gray-400 bg-clip-text text-transparent">
        Error Handling</h1>
    <p class="text-lg text-gray-400">Robust exception hierarchy for production reliability.</p>
</div>

<!-- Exception Hierarchy -->
<section class="mb-16">
    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-red-500/20 to-red-500/5 flex items-center justify-center">
            <i data-lucide="alert-triangle" class="w-4 h-4 text-red-500"></i>
        </div>
        Exception Hierarchy
    </h2>

    <div class="relative">
        <div class="absolute -inset-1 bg-gradient-to-r from-red-500/10 to-orange-500/10 rounded-2xl blur opacity-25">
        </div>
        <div class="relative bg-zinc-950/90 backdrop-blur-sm border border-white/10 rounded-2xl p-6">
            <div class="font-mono text-sm space-y-2">
                <div class="text-red-400">TuboxException</div>
                <div class="ml-4 text-orange-400">├── AuthenticationError</div>
                <div class="ml-4 text-orange-400">├── UnauthorizedError</div>
                <div class="ml-4 text-orange-400">├── NotFoundError</div>
                <div class="ml-8 text-yellow-400">│ ├── DocumentNotFoundError</div>
                <div class="ml-8 text-yellow-400">│ ├── CollectionNotFoundError</div>
                <div class="ml-8 text-yellow-400">│ └── DatabaseNotFoundError</div>
                <div class="ml-4 text-orange-400">├── RateLimitExceededError</div>
                <div class="ml-4 text-orange-400">├── QuotaExceededError</div>
                <div class="ml-4 text-orange-400">└── TransactionError</div>
                <div class="ml-8 text-yellow-400"> ├── TransactionAbortedError</div>
                <div class="ml-8 text-yellow-400"> └── TransactionTimeoutError</div>
            </div>
        </div>
    </div>
</section>

<!-- Common Exceptions -->
<section class="mb-16">
    <h2 class="text-2xl font-bold text-white mb-6">Common Exceptions</h2>

    <div class="space-y-4">
        <!-- AuthenticationError -->
        <div class="group p-5 bg-zinc-900/50 border border-white/5 rounded-xl hover:border-red-500/20 transition-all">
            <div class="flex items-start gap-4 mb-3">
                <div class="w-10 h-10 rounded-lg bg-red-500/10 flex items-center justify-center flex-shrink-0">
                    <i data-lucide="lock" class="w-5 h-5 text-red-500"></i>
                </div>
                <div class="flex-1">
                    <code class="text-lg font-mono text-red-400">AuthenticationError</code>
                    <p class="text-sm text-gray-400 mt-2">Raised when login credentials are invalid or session has
                        expired.</p>
                </div>
            </div>
            <div class="ml-14 bg-black/30 rounded-lg p-4 border border-white/5">
                <pre class="text-xs text-gray-300"><code class="language-python"><span class="text-crous-400">try</span>:
    <span class="text-crous-400">await</span> client.authenticate(username, password)
<span class="text-crous-400">except</span> AuthenticationError <span class="text-crous-400">as</span> e:
    logger.error(f<span class="text-green-400">"Login failed: {e.message}"</span>)
    <span class="text-gray-500"># Retry with different credentials or notify user</span></code></pre>
            </div>
        </div>

        <!-- RateLimitExceededError -->
        <div
            class="group p-5 bg-zinc-900/50 border border-white/5 rounded-xl hover:border-yellow-500/20 transition-all">
            <div class="flex items-start gap-4 mb-3">
                <div class="w-10 h-10 rounded-lg bg-yellow-500/10 flex items-center justify-center flex-shrink-0">
                    <i data-lucide="gauge" class="w-5 h-5 text-yellow-500"></i>
                </div>
                <div class="flex-1">
                    <code class="text-lg font-mono text-yellow-400">RateLimitExceededError</code>
                    <p class="text-sm text-gray-400 mt-2">Request rate too high. Includes <code
                            class="text-white">retry_after</code> seconds in error details.</p>
                </div>
            </div>
            <div class="ml-14 bg-black/30 rounded-lg p-4 border border-white/5">
                <pre class="text-xs text-gray-300"><code class="language-python"><span class="text-crous-400">try</span>:
    result = <span class="text-crous-400">await</span> collection.find(query)
<span class="text-crous-400">except</span> RateLimitExceededError <span class="text-crous-400">as</span> e:
    retry_after = e.details.get(<span class="text-green-400">"retry_after"</span>, <span class="text-blue-400">60</span>)
    <span class="text-crous-400">await</span> asyncio.sleep(retry_after)
    <span class="text-gray-500"># Retry request</span></code></pre>
            </div>
        </div>

        <!-- TransactionError -->
        <div
            class="group p-5 bg-zinc-900/50 border border-white/5 rounded-xl hover:border-purple-500/20 transition-all">
            <div class="flex items-start gap-4 mb-3">
                <div class="w-10 h-10 rounded-lg bg-purple-500/10 flex items-center justify-center flex-shrink-0">
                    <i data-lucide="git-branch" class="w-5 h-5 text-purple-500"></i>
                </div>
                <div class="flex-1">
                    <code class="text-lg font-mono text-purple-400">TransactionError</code>
                    <p class="text-sm text-gray-400 mt-2">Transaction failed to commit or was aborted due to conflicts.
                    </p>
                </div>
            </div>
            <div class="ml-14 bg-black/30 rounded-lg p-4 border border-white/5">
                <pre
                    class="text-xs text-gray-300"><code class="language-python"><span class="text-crous-400">try</span>:
    <span class="text-crous-400">async with</span> session.start_transaction():
        <span class="text-gray-500"># ... operations ...</span>
<span class="text-crous-400">except</span> TransactionAbortedError:
    <span class="text-gray-500"># Conflict detected, retry with exponential backoff</span>
    <span class="text-crous-400">await</span> asyncio.sleep(<span class="text-blue-400">0.1</span> * (<span class="text-blue-400">2</span> ** retry_count))</code></pre>
            </div>
        </div>
    </div>
</section>

<!-- Best Practices -->
<section class="mb-16">
    <h2 class="text-2xl font-bold text-white mb-6">Best Practices</h2>

    <div class="space-y-4">
        <div class="p-5 bg-gradient-to-br from-green-500/5 to-transparent border border-green-500/20 rounded-xl">
            <div class="flex items-start gap-3">
                <i data-lucide="check-circle" class="w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"></i>
                <div>
                    <h3 class="text-white font-bold mb-2">Catch Specific Exceptions</h3>
                    <p class="text-sm text-gray-400">Always catch specific exceptions rather than the base <code
                            class="text-white">TuboxException</code> for better error handling.</p>
                </div>
            </div>
        </div>

        <div class="p-5 bg-gradient-to-br from-blue-500/5 to-transparent border border-blue-500/20 rounded-xl">
            <div class="flex items-start gap-3">
                <i data-lucide="repeat" class="w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"></i>
                <div>
                    <h3 class="text-white font-bold mb-2">Implement Retry Logic</h3>
                    <p class="text-sm text-gray-400">Use exponential backoff for transient errors like <code
                            class="text-white">RateLimitExceededError</code> and <code
                            class="text-white">TransactionAbortedError</code>.</p>
                </div>
            </div>
        </div>

        <div class="p-5 bg-gradient-to-br from-purple-500/5 to-transparent border border-purple-500/20 rounded-xl">
            <div class="flex items-start gap-3">
                <i data-lucide="file-text" class="w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"></i>
                <div>
                    <h3 class="text-white font-bold mb-2">Log Error Details</h3>
                    <p class="text-sm text-gray-400">All exceptions include <code class="text-white">message</code>,
                        <code class="text-white">code</code>, and <code class="text-white">details</code> attributes for
                        debugging.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Navigation -->
<div class="flex items-center justify-between pt-12 mt-12 border-t border-white/10">
    <a href="/docs/python/results" class="group flex items-center gap-2 text-gray-400 hover:text-white transition-all">
        <i data-lucide="arrow-left" class="w-4 h-4 group-hover:-translate-x-1 transition-transform"></i>
        <span>Result Classes</span>
    </a>
    <a href="/docs/python/configuration"
        class="group flex items-center gap-2 text-white font-bold hover:text-crous-400 transition-all">
        <span>Configuration</span>
        <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
    </a>
</div>

{% endblock %}