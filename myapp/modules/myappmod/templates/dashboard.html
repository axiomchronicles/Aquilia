{% extends "base.html" %}

{% block title %}Dashboard - Aquilia App{% endblock %}

{% block content %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
    <div class="card">
        <h3 style="color: #667eea; margin-bottom: 0.5rem;">ğŸ‘¤ User Profile</h3>
        <p style="color: #666;">
            {% if authenticated %}
                <strong>{{ identity.username }}</strong>
                <br>
                {% if has_role('admin') %}
                    <span class="badge badge-primary">Administrator</span>
                {% else %}
                    <span class="badge badge-success">Regular User</span>
                {% endif %}
            {% else %}
                Not authenticated
            {% endif %}
        </p>
    </div>
    
    <div class="card">
        <h3 style="color: #667eea; margin-bottom: 0.5rem;">ğŸ” Session Info</h3>
        <p style="color: #666; font-size: 0.9rem;">
            <strong>Session ID:</strong><br>
            <code style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 3px;">
                {{ session.id | default('No session') }}
            </code>
        </p>
    </div>
    
    <div class="card">
        <h3 style="color: #667eea; margin-bottom: 0.5rem;">ğŸ“Š Stats</h3>
        <p style="color: #666;">
            Auth Status: <strong>{{ is_authenticated() | default('False') }}</strong><br>
            Session Active: <strong>{{ session is not none | default('False') }}</strong>
        </p>
    </div>
</div>

<div class="card">
    <h2 style="color: #333; margin-bottom: 1rem;">Welcome to Dashboard</h2>
    
    {% if authenticated %}
        <p style="color: #666; line-height: 1.6;">
            Welcome, <strong>{{ identity.username }}</strong>! This dashboard demonstrates the Aquilia framework's 
            comprehensive features including:
        </p>
        
        <ul style="color: #666; line-height: 1.8; margin-left: 1.5rem; margin-top: 1rem;">
            <li>âœ… <strong>Template Rendering</strong> - Dynamic HTML with Jinja2</li>
            <li>âœ… <strong>Authentication</strong> - Bearer token & session-based auth</li>
            <li>âœ… <strong>Session Management</strong> - Persistent user sessions with cookies</li>
            <li>âœ… <strong>Dependency Injection</strong> - Services and repositories</li>
            <li>âœ… <strong>Middleware Integration</strong> - Auth, sessions, error handling</li>
            <li>âœ… <strong>Role-Based Access Control</strong> - Admin/user roles</li>
            <li>âœ… <strong>Flash Messages</strong> - Temporary notifications</li>
        </ul>
        
        <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
            <a href="/myappmod/sessions/list" class="btn btn-primary">View Sessions</a>
            <a href="/myappmod/profile" class="btn btn-primary">User Profile</a>
            {% if has_role('admin') %}
                <a href="/myappmod/admin/users" class="btn btn-primary">Manage Users</a>
            {% endif %}
            <a href="/myappmod/logout" class="btn btn-danger">Logout</a>
        </div>
    {% else %}
        <p style="color: #666;">Please <a href="/myappmod/login" style="color: #667eea;">login</a> to access the dashboard.</p>
    {% endif %}
</div>

<div class="card">
    <h3 style="color: #333; margin-bottom: 1rem;">ğŸ“‹ Request Context</h3>
    <table>
        <tr>
            <th>Property</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Request Path</td>
            <td><code>{{ request.path }}</code></td>
        </tr>
        <tr>
            <td>Request Method</td>
            <td><code>{{ request.method }}</code></td>
        </tr>
        <tr>
            <td>Authenticated</td>
            <td>{{ is_authenticated() }}</td>
        </tr>
        <tr>
            <td>Session Type</td>
            <td>{{ session is not none | default('None') }}</td>
        </tr>
        {% if authenticated %}
        <tr>
            <td>User ID</td>
            <td><code>{{ identity.id }}</code></td>
        </tr>
        <tr>
            <td>Has Admin Role</td>
            <td>{{ has_role('admin') }}</td>
        </tr>
        {% endif %}
    </table>
</div>
{% endblock %}
